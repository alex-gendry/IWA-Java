name: Fortify on Demand SAST Scan (GHA)
on:
  workflow_dispatch:
  push:
  pull_request:
  

jobs:
  FOD-SAST:
    runs-on: self-hosted
    container:
      image: fortifydocker/fortify-ci-tools
    
    steps:    
      - name: Check out source code
        uses: actions/checkout@v4  
      - name: Run FoD SAST Scan
        uses: fortify/github-action/fod-sast-scan@v1
        env:
          FOD_URL: https://ams.fortify.com
          FOD_TENANT: ${{secrets.FOD_TENANT}}
          FOD_USER: ${{secrets.FOD_USER}}
          FOD_PASSWORD: ${{secrets.FOD_PAT}}
          # EXTRA_FOD_LOGIN_OPTS: --socket-timeout=60s
          FOD_RELEASE: '${{ github.event.repository.name }} [AG]:${{ github.ref_name }}'
          EXTRA_PACKAGE_OPTS: -oss
          DO_WAIT: true
          # DO_EXPORT: true
